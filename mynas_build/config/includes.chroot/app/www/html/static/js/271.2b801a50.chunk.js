"use strict";(self.webpackChunkmypxe_admin=self.webpackChunkmypxe_admin||[]).push([[271],{41523:function(n,e,t){t.r(e);var r=t(47313),o=t(75908),a=t(9289),i=t(61113),c=t(47131),l=t(24272),s=t(96944),u=t(36555),d=t(8586),p=(t(37982),t(46417)),f=(0,r.forwardRef)((function(n,e){var t=n.onActive,r=n.onClose,f=n.onRestore,h=n.onMaximize,Z=n.onMinimize;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.Z,{sx:{position:"relative"},children:(0,p.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,p.jsx)(i.Z,{variant:"h6",component:"div",sx:{flexGrow:1,cursor:"move"},className:"window-title",onClick:t,children:n.title}),(0,p.jsx)(c.Z,{color:"inherit",onClick:Z,children:(0,p.jsx)(l.Z,{})}),n.isMaximized?(0,p.jsx)(c.Z,{color:"inherit",onClick:f,children:(0,p.jsx)(s.Z,{})}):(0,p.jsx)(c.Z,{color:"inherit",onClick:h,children:(0,p.jsx)(u.Z,{})}),(0,p.jsx)(c.Z,{color:"inherit",onClick:r,children:(0,p.jsx)(d.Z,{})})]})}),n.children]})}));e.default=f},38271:function(n,e,t){t.r(e),t.d(e,{default:function(){return I}});var r=t(74165),o=t(15861),a=t(1413),i=t(29439),c=t(47313),l=t(79185),s=t(46817),u=t(60786),d=(t(66641),t(60270)),p=(t(147),t(37982)),f=t(10724),h=t(10437),Z=t(51629),x=t(70501),g=t(66835),v=t(23477),m=t(24076),k=t(67478),j=t(57861),w=t(69099),_=t(99783),b=t(96467),C=t(66149),y=t(33604),S=t(4117),B=t(40762),A=t(41523),z=t(46417);function P(n){var e=(0,c.useRef)(null),t=(0,c.useRef)(null),r=(0,c.useState)(""),o=(0,i.Z)(r,2);o[0],o[1];return(0,c.useEffect)((function(){e.current=new u.Terminal({rows:40,convertEol:!0,scrollback:10,disableStdin:!1,cursorStyle:"underline",cursorBlink:!0});var r=new d.FitAddon;e.current.loadAddon(r),e.current.onResize((function(n){r.fit()})),e.current.open(t.current),null!=n.data&&l.default[n.data.op](n.data,{stdout:function(n){console.log("up_container=",n),e.current&&e.current.write(n)},stderr:function(n){console.log("up_container stderr=",n)},onerr:function(n){console.log("up_container err=",n)}})}),[n]),(0,z.jsx)(h.Z,{ref:t,width:"100vh",height:"100vh"})}function D(n){var e=(0,c.useState)({page:0,filter:"",rowsPerPage:10,dockerlist:n.data||[],loading:!0}),t=(0,i.Z)(e,2),l=t[0],s=t[1],u=function(n){s((function(e){return(0,a.Z)((0,a.Z)({},e),n)}))},d=l.dockerlist.filter((function(n){return Object.values(n).some((function(n){return n.toString().toLowerCase().includes(l.filter.toLowerCase())}))})),f=(0,p.useData)(),h=(f.global_data,f.api),b=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(){var e,t,o,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=l.dockerlist,t=0;case 2:if(!(t<e.length)){n.next=11;break}return n.next=5,h.run_command({command:"/bin/bash",args:["-c","cd /app/docker/".concat(e[t].name,"&&docker compose ps --format json")]});case 5:0==(o=n.sent).ret&&(i=JSON.parse(o.data.stdout),e[t]=(0,a.Z)((0,a.Z)({},e[t]),i)),u({dockerlist:e});case 8:t++,n.next=2;break;case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,c.useEffect)((function(){u({dockerlist:n.data}),b();var e=setInterval((0,o.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:b();case 1:case"end":return n.stop()}}),n)}))),1e4);return function(){clearInterval(e)}}),[]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Z.Z,{component:x.Z,children:(0,z.jsxs)(g.Z,{children:[(0,z.jsx)(v.Z,{children:(0,z.jsxs)(m.Z,{children:[(0,z.jsx)(k.Z,{children:"\u64cd\u4f5c"}),(0,z.jsx)(k.Z,{children:"\u540d\u79f0"}),(0,z.jsx)(k.Z,{children:"\u72b6\u6001"}),(0,z.jsx)(k.Z,{children:"\u7aef\u53e3"}),(0,z.jsx)(k.Z,{children:"mount"}),(0,z.jsx)(k.Z,{children:"Status"})]})}),(0,z.jsx)(j.Z,{children:d.slice(l.page*l.rowsPerPage,l.page*l.rowsPerPage+l.rowsPerPage).map((function(e){return(0,z.jsxs)(m.Z,{children:[(0,z.jsxs)(k.Z,{children:[n.onUp&&"running"!=e.State&&(0,z.jsx)(w.Z,{onClick:function(){return n.onUp(e)},children:"\u542f\u52a8"}),n.onDown&&"running"==e.State&&(0,z.jsx)(w.Z,{onClick:function(){return n.onDown(e)},children:"\u505c\u6b62"}),n.onConfig&&(0,z.jsx)(w.Z,{onClick:function(){return n.onConfig(e)},children:"\u914d\u7f6e"})]}),(0,z.jsx)(k.Z,{children:e.name}),(0,z.jsx)(k.Z,{children:e.State}),(0,z.jsx)(k.Z,{children:e.Ports}),(0,z.jsx)(k.Z,{children:e.Mounts}),(0,z.jsx)(k.Z,{children:e.Status})]},e.name)}))})]})}),(0,z.jsx)(_.Z,{component:"div",count:d.length,page:l.page,onPageChange:function(n,e){u({page:e})},rowsPerPage:l.rowsPerPage,onRowsPerPageChange:function(n){u({rowsPerPage:parseInt(n.target.value,10),page:0})},style:{marginTop:"1rem"}})]})}var R=function(n){var e=(0,c.useRef)(null),t=(0,c.useRef)(null),r=(0,c.useState)(""),o=(0,i.Z)(r,2);o[0],o[1];return(0,c.useEffect)((function(){e.current=new u.Terminal({rows:40,convertEol:!0,scrollback:10,disableStdin:!1,cursorStyle:"underline",cursorBlink:!0});var r=new d.FitAddon;e.current.loadAddon(r),e.current.onResize((function(n){r.fit()})),e.current.open(t.current),null!=n.data&&l.default[n.data.op]({stdout:function(n){e.current&&e.current.write(n)},stderr:function(n){console.log("up_container stderr=",n)},onerr:function(n){console.log("up_container err=",n)},onend:function(){n.onEnd&&n.onEnd()}})}),[n]),(0,z.jsx)(h.Z,{ref:t,width:"100vh",height:"100vh"})};function I(n){var e=(0,c.useState)({data:{title:"",env:"",config:""},dockerlist:[],installed:!1,open_dialog:!1,open_container_up_dialog:!1,cur_container:null,schema:{type:"object",title:"\u65b0\u5efadocker\u5bb9\u5668",properties:{title:{type:"string",title:"\u5bb9\u5668\u540d\u79f0"},env:{type:"string",title:"\u73af\u5883\u53d8\u91cf",format:"ini",default:"",options:{ace:{theme:"ace/theme/vibrant_ink",tabSize:2,useSoftTabs:!0,wrap:!0}}},config:{type:"string",format:"yaml",title:"docker-compose\u914d\u7f6e",default:"",options:{ace:{theme:"ace/theme/vibrant_ink",tabSize:2,useSoftTabs:!0,wrap:!0}}}},require:["title","env","config"]}}),t=(0,i.Z)(e,2),u=t[0],d=t[1],h=(0,p.useData)(),Z=(h.global_data,h.api),x=function(n){d((function(e){return(0,a.Z)((0,a.Z)({},e),n)}))},g=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(){var e,t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Z.config_file({filename:"config/container.config",op:"get"});case 2:0==(e=n.sent).ret&&e.data&&(t=JSON.parse(e.data),console.log("get docker list config====",t),x({dockerlist:t||[]}));case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),v=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(){var e,t,o,a,i,c,s,u,d,p,f,h;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.default.check_install();case 2:if(0!=(e=n.sent).ret||!e.data||""==e.data.stdout){n.next=11;break}return x({install_dialog:!1,run_command:{},installed:!0}),n.next=7,g();case 7:return n.next=9,l.default.list_all();case 9:if(0==(t=n.sent).ret&&t.data&&""!=t.data.stdout){for(o=t.data.stdout,a=o.split("\n"),i=[],c=1;c<a.length-1;c++)i.push(a[c]);if(i.length>1)for(s=i[0].split(/\s+/),u=[],d=1;d<i.length;d++){for(p=i[d].split(/\s+/),f={},h=0;h<s.length;h++)f[s[h]]=p[h];u.push(f)}}case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),m=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e={},u.installed||(e={op:"install"}),e.op?x({install_dialog:!0,run_command:e}):x({install_dialog:!1});case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),k=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:x({cur_container:(0,a.Z)((0,a.Z)({},e),{},{op:"start_container"}),open_container_up_dialog:!0});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),j=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:x({cur_container:(0,a.Z)((0,a.Z)({},e),{},{op:"stop_container"}),open_container_up_dialog:!0});case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),_=function(){return(0,z.jsx)(D,{data:u.dockerlist,onUp:k,onConfig:T,onDown:j})},I=function(){x({open_dialog:!1})},M=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(e){var t,o,a,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=E.current.getValue(),n.next=3,l.default.save_config(t);case 3:if(o=n.sent,a=u.dockerlist,0!=o.ret){n.next=12;break}return i=a.findIndex((function(n){return n.dir=="".concat(l.default.docker_config,"/").concat(t.title)})),i>=0?a.splice(i,1,{name:t.title,dir:"".concat(l.default.docker_config,"/").concat(t.title)}):a.push({name:t.title,dir:"".concat(l.default.docker_config,"/").concat(t.title)}),n.next=10,Z.config_file({filename:"config/container.config",op:"put",data:JSON.stringify(a)});case 10:n.sent,x({dockerlist:a,open_dialog:!1});case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),O=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=(0,a.Z)((0,a.Z)({},u.schema),{},{title:"\u65b0\u5efa"}),x({open_dialog:!0,schema:e});case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),T=function(){var n=(0,o.Z)((0,r.Z)().mark((function n(e){var t,o,i,c;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=(0,a.Z)((0,a.Z)({},u.schema),{},{title:"\u4fee\u6539\u5bb9\u5668"}),o=e.name,i=e.dir,n.next=5,l.default.get_config({title:o,dir:i});case 5:0==(c=n.sent).ret&&x({schema:t,title:e.name,env:c.env.data,config:c.compose.data,open_dialog:!0});case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),E=(0,c.useRef)(null),N=(0,f.Z)(b.Z)({width:"80%"}),F=function(){return(0,z.jsxs)(C.Z,{open:u.open_dialog,onClose:I,fullWidth:!0,maxWidth:"md",children:[(0,z.jsx)(y.Z,{children:"\u914d\u7f6e"}),(0,z.jsx)(N,{children:(0,z.jsx)(s.default,{schema:u.schema,ref:E,data:u.data})}),(0,z.jsxs)(S.Z,{children:[(0,z.jsx)(w.Z,{onClick:M,children:"\u4fdd\u5b58"}),(0,z.jsx)(w.Z,{onClick:I,children:"\u53d6\u6d88"})]})]})},H=function(){x({open_container_up_dialog:!1})};(0,c.useEffect)((function(){return v(),function(){}}),[]);var W=function(){return(0,z.jsxs)(C.Z,{open:u.open_container_up_dialog,onClose:H,fullWidth:!0,maxWidth:"md",children:[(0,z.jsx)(y.Z,{children:"\u542f\u52a8\u5bb9\u5668"}),(0,z.jsx)(N,{children:(0,z.jsx)(P,{data:u.cur_container})}),(0,z.jsx)(S.Z,{children:(0,z.jsx)(w.Z,{onClick:H,children:"\u53d6\u6d88"})})]})};return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(A.default,(0,a.Z)((0,a.Z)({title:"docker"},n),{},{children:(0,z.jsxs)(B.Z,{children:[!u.installed&&(0,z.jsx)(w.Z,{onClick:m,children:"\u5b89\u88c5docker"}),u.installed&&(0,z.jsx)(w.Z,{onClick:O,children:"\u65b0\u5efa\u5bb9\u5668"}),(0,z.jsx)(_,{}),(0,z.jsx)(F,{}),(0,z.jsx)(W,{}),u.install_dialog&&(0,z.jsxs)(C.Z,{open:u.install_dialog,onClose:function(){return console.log("close")},children:[(0,z.jsx)(y.Z,{children:"\u521d\u59cb\u5316"}),(0,z.jsx)(N,{children:(0,z.jsx)(R,{data:u.run_command,onEnd:v})}),(0,z.jsx)(S.Z,{})]})]})}))})}},8586:function(n,e,t){var r=t(81171),o=t(46417);e.Z=(0,r.Z)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},36555:function(n,e,t){var r=t(81171),o=t(46417);e.Z=(0,r.Z)((0,o.jsx)("path",{d:"M3 3h18v2H3z"}),"Maximize")},24272:function(n,e,t){var r=t(81171),o=t(46417);e.Z=(0,r.Z)((0,o.jsx)("path",{d:"M6 19h12v2H6z"}),"Minimize")},96944:function(n,e,t){var r=t(81171),o=t(46417);e.Z=(0,r.Z)((0,o.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"Restore")},75908:function(n,e,t){t.d(e,{Z:function(){return m}});var r=t(63366),o=t(87462),a=t(47313),i=t(83061),c=t(21921),l=t(17592),s=t(77342),u=t(91615),d=t(70501),p=t(77430),f=t(32298);function h(n){return(0,f.Z)("MuiAppBar",n)}(0,p.Z)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);var Z=t(46417),x=["className","color","enableColorOnDark","position"],g=function(n,e){return n?"".concat(null==n?void 0:n.replace(")",""),", ").concat(e,")"):e},v=(0,l.ZP)(d.Z,{name:"MuiAppBar",slot:"Root",overridesResolver:function(n,e){var t=n.ownerState;return[e.root,e["position".concat((0,u.Z)(t.position))],e["color".concat((0,u.Z)(t.color))]]}})((function(n){var e=n.theme,t=n.ownerState,r="light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900];return(0,o.Z)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===t.position&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===t.position&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===t.position&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},"static"===t.position&&{position:"static"},"relative"===t.position&&{position:"relative"},!e.vars&&(0,o.Z)({},"default"===t.color&&{backgroundColor:r,color:e.palette.getContrastText(r)},t.color&&"default"!==t.color&&"inherit"!==t.color&&"transparent"!==t.color&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},"inherit"===t.color&&{color:"inherit"},"dark"===e.palette.mode&&!t.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===t.color&&(0,o.Z)({backgroundColor:"transparent",color:"inherit"},"dark"===e.palette.mode&&{backgroundImage:"none"})),e.vars&&(0,o.Z)({},"default"===t.color&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette.AppBar.defaultBg:g(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":t.enableColorOnDark?e.vars.palette.text.primary:g(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},t.color&&!t.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette[t.color].main:g(e.vars.palette.AppBar.darkBg,e.vars.palette[t.color].main),"--AppBar-color":t.enableColorOnDark?e.vars.palette[t.color].contrastText:g(e.vars.palette.AppBar.darkColor,e.vars.palette[t.color].contrastText)},{backgroundColor:"var(--AppBar-background)",color:"inherit"===t.color?"inherit":"var(--AppBar-color)"},"transparent"===t.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),m=a.forwardRef((function(n,e){var t=(0,s.Z)({props:n,name:"MuiAppBar"}),a=t.className,l=t.color,d=void 0===l?"primary":l,p=t.enableColorOnDark,f=void 0!==p&&p,g=t.position,m=void 0===g?"fixed":g,k=(0,r.Z)(t,x),j=(0,o.Z)({},t,{color:d,position:m,enableColorOnDark:f}),w=function(n){var e=n.color,t=n.position,r=n.classes,o={root:["root","color".concat((0,u.Z)(e)),"position".concat((0,u.Z)(t))]};return(0,c.Z)(o,h,r)}(j);return(0,Z.jsx)(v,(0,o.Z)({square:!0,component:"header",ownerState:j,elevation:4,className:(0,i.default)(w.root,a,"fixed"===m&&"mui-fixed"),ref:e},k))}))}}]);