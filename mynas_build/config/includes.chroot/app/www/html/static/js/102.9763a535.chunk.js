"use strict";(self.webpackChunkmypxe_admin=self.webpackChunkmypxe_admin||[]).push([[102,523,425,811,548,547],{41523:function(e,n,t){t.r(n);var r=t(47313),o=t(75908),a=t(9289),i=t(61113),c=t(47131),s=t(24272),l=t(96944),u=t(36555),d=t(8586),f=(t(37982),t(46417)),p=(0,r.forwardRef)((function(e,n){var t=e.onActive,r=e.onClose,p=e.onRestore,m=e.onMaximize,v=e.onMinimize;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o.Z,{sx:{position:"relative"},children:(0,f.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,f.jsx)(i.Z,{variant:"h6",component:"div",sx:{flexGrow:1,cursor:"move"},className:"window-title",onClick:t,children:e.title}),(0,f.jsx)(c.Z,{color:"inherit",onClick:v,children:(0,f.jsx)(s.Z,{})}),e.isMaximized?(0,f.jsx)(c.Z,{color:"inherit",onClick:p,children:(0,f.jsx)(l.Z,{})}):(0,f.jsx)(c.Z,{color:"inherit",onClick:m,children:(0,f.jsx)(u.Z,{})}),(0,f.jsx)(c.Z,{color:"inherit",onClick:r,children:(0,f.jsx)(d.Z,{})})]})}),e.children]})}));n.default=p},83102:function(e,n,t){t.r(n);var r=t(29439),o=t(1413),a=t(47313),i=t(65489),c=(t(43772),t(47425)),s=(t(63469),t(63705),t(69393),t(84724),t(79185)),l=t(71547),u=t(70811),d=t(5548),f=t(37982),p=(t(46817),t(60786),t(66641),t(60270),t(147),t(41523),t(66109),t(46417)),m=window,v=(m.Metro,m.$,function(e){return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",(0,o.Z)((0,o.Z)({},e),{},{children:"VMSetting"}))})}),h={system:function(e){return(0,p.jsx)(l.default.Render,(0,o.Z)({},e))},persistence:function(e){return(0,p.jsx)(d.default.Setting,(0,o.Z)({},e))},docker:function(e){return(0,p.jsx)(s.default.RendSetting,(0,o.Z)({},e))},virtual:function(e){return(0,p.jsx)(v,(0,o.Z)({},e))},cron:function(e){return(0,p.jsx)(u.default.Render,(0,o.Z)({},e))}},x=(0,a.forwardRef)((function(e,n){var t=a.createRef(),s=a.createRef(),l=(0,f.rix_make_watch_data)({curshow:"persistence"}),u=function(e){var n=(0,a.useState)(0),t=(0,r.Z)(n,2),o=t[0],i=t[1];return(0,a.useEffect)((function(){var e=l.watch("curshow",(function(){i(o+1)}));return function(){l.unwatch("curshow",e)}})),console.log("view_config=",h,l),(0,p.jsx)(p.Fragment,{children:h[l.curshow](e)})};return(0,p.jsxs)(i.default,(0,o.Z)((0,o.Z)({},e),{},{ref:n,children:[(0,p.jsxs)(c.default,{onClick:function(e){l.set("curshow",e)},toggle_ref:t,shift_ref:s,children:[(0,p.jsxs)("div",{className:"sidebar-header",slot:"header",children:[(0,p.jsx)("span",{className:"title fg-white",children:"test"}),(0,p.jsx)("span",{className:"subtitle fg-white",children:" test"})]}),(0,p.jsx)("li",{children:(0,p.jsxs)("a",{"data-menu":"system",children:[(0,p.jsx)("span",{className:"mif-books icon"}),"\u7cfb\u7edf"]})}),(0,p.jsx)("li",{children:(0,p.jsxs)("a",{"data-menu":"persistence",children:[(0,p.jsx)("span",{className:"mif-books icon"}),"\u6301\u4e45\u5316"]})}),(0,p.jsx)("li",{children:(0,p.jsxs)("a",{"data-menu":"docker",children:[(0,p.jsx)("span",{className:"mif-books icon"}),"docker\u8bbe\u7f6e"]})}),(0,p.jsx)("li",{children:(0,p.jsxs)("a",{"data-menu":"virtual",children:[(0,p.jsx)("span",{className:"mif-files-empty icon"}),"\u865a\u62df\u673a\u8bbe\u7f6e"]})}),(0,p.jsx)("li",{children:(0,p.jsxs)("a",{"data-menu":"cron",children:[(0,p.jsx)("span",{className:"mif-files-empty icon"}),"\u5b9a\u65f6\u4efb\u52a1"]})}),(0,p.jsx)("li",{className:"divider"})]}),(0,p.jsxs)("div",{className:"shifted-content h-100 p-ab",ref:s,children:[(0,p.jsx)("div",{className:"app-bar pos-absolute bg-red z-1","data-role":"appbar",children:(0,p.jsx)("button",{className:"app-bar-item c-pointer",id:"sidebar-toggle-3",ref:t,children:(0,p.jsx)("span",{className:"mif-menu fg-white"})})}),(0,p.jsx)(u,{className:"h-100 p-4",style:{display:"flex",flexDirection:"column",flexWrap:"nowrap",alignItems:"flex-start"}})]})]}))}));n.default=x},47425:function(e,n,t){t.r(n),t.d(n,{default:function(){return f}});var r=t(1413),o=t(45987),a=t(29439),i=t(47313),c=(t(1168),t(52794),t(46417)),s=["children","onClick","toggle_ref","shift_ref"],l=window,u=l.Metro,d=l.$;function f(e){var n=(0,i.useState)(0),t=(0,a.Z)(n,2),l=(t[0],t[1],i.createRef()),f=e.children,p=e.onClick,m=e.toggle_ref,v=e.shift_ref,h=(0,o.Z)(e,s);(0,i.useEffect)((function(){u.makePlugin(l.current,"sidebar",(0,r.Z)({shift:v.current,toggle:m.current,menuItemClick:!1},h)).data("sidebar").element.on("click",".sidebar-menu li  > a",(function(e){e.preventDefault();var n=d(e.target);p&&p(n.data("menu"),e)}))}));var x=f.filter((function(e){return"header"==e.props.slot})),g=f.filter((function(e){return"header"!=e.props.slot}));return(0,c.jsxs)("aside",{className:"sidebar pos-absolute z-2",ref:l,children:[x,(0,c.jsxs)("ul",{className:"sidebar-menu",children:[g," "]})]})}},70811:function(e,n,t){t.r(n);var r=t(29439),o=t(1413),a=t(74165),i=t(15861),c=t(47313),s=t(69393),l=t(63469),u=t(63705),d=(t(47610),t(86385)),f=t(56659),p=t(84724),m=t(37982),v=(t(66109),t(94536)),h=t(46817),x=(t(60786),t(66641),t(60270),t(147),t(70816),t(46417)),g=(m.context_value.global_data,m.context_value.api),w={list:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.run_command({command:"crontab",args:["-l"]});case 2:if(0!=(n=e.sent).ret){e.next=8;break}if(!n.data.stdout.startsWith("no crontab")){e.next=7;break}return e.abrupt("return",{ret:0,data:[]});case 7:return e.abrupt("return",{ret:-2,error:n.data.stdout});case 8:return e.abrupt("return",{ret:-2,error:n});case 9:case"end":return e.stop()}}),e)})))()},reload_cron:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.run_command({command:"crontab",args:["/app/cron/.cron"]});case 2:n=e.sent,console.log("reload_cron ret=",n);case 4:case"end":return e.stop()}}),e)})))()},load_cron:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.config_file({filename:"/app/cron/.cron",op:"get"});case 3:return n=e.sent,e.abrupt("return",w.parse_cron(n));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},save_cron:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.default.mkdir("/app/cron");case 2:return n="",w.cron_list.list.forEach((function(e){n+="".concat(e.cron," \t bash /app/cron/").concat(e.script,"\n")})),e.next=6,g.config_file({op:"put",filename:"/app/cron/.cron",data:n});case 6:return e.sent,e.next=9,w.reload_cron();case 9:case"end":return e.stop()}}),e)})))()},parse_cron:function(e){var n=e.split("\n"),t=[];n.forEach((function(e){var n=e.trim().split(/\s+/);if(n.length>6){var r="",o=0;for(o=0;o<5;o++)r+="".concat(n[o]," ");var a=n[++o];t.push({cron:r,script:a})}})),console.log("set_list===",t),w.cron_list.set("list",t)},CronScriptRemove:function(e){var n=w.cron_list.list,t=n.findIndex((function(n){return n.script==e.filename}));t>=0&&n.splice(t,1),w.save_cron(),v.default.rm(e.filename),w.cron_list.set("list",n)},CronScriptEdit:function(e){var n=e.filename,t=e.data;console.log("CronScriptEdit props=",e);s.WindowApi.windows,s.WindowApi.getApps,s.WindowApi.openWindow,s.WindowApi.set_window_ref;var r=s.WindowApi.openDialog,d=s.WindowApi.closeDialog,f=(0,o.Z)((0,o.Z)({},p.default),{},{$ref:"#/definitions/cron_edit_script"}),m="dialog_"+Date.now(),v=function(){var t=(0,i.Z)((0,a.Z)().mark((function t(r){var o,i,c,s;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.cron,i=r.script,t.next=4,g.config_file({op:"put",filename:"".concat(n),data:i});case 4:t.sent,o!=e.cron&&(c=w.cron_list.list,(s=c.findIndex((function(e){return e.script==n})))>=0&&c.splice(s,1,{cron:o,script:n}),w.save_cron(),w.cron_list.set("list",c)),d(m);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),b={cron:e.cron,script:t},j=function(){var e=(0,c.useRef)(null);return(0,x.jsxs)(u.default,{width:"fit-content",children:[(0,x.jsx)("div",{type:"title",children:"\u7f16\u8f91\u811a\u672c"}),(0,x.jsx)("div",{type:"content",children:(0,x.jsx)(h.default,{schema:f,ref:e,data:b})}),(0,x.jsx)(l.default,{type:"action",className:"button success",onClick:function(){var n=e.current.getValue();v(n)},children:"\u4fdd\u5b58"}),(0,x.jsx)("button",{type:"action",className:"button js-dialog-close",children:"\u5173\u95ed"})]})};r({id:m,content:(0,x.jsx)(j,{id:m})})},CronDialog:function(e){var n=e.title,t=e.data,r=(s.WindowApi.windows,s.WindowApi.getApps,s.WindowApi.openWindow,s.WindowApi.set_window_ref,s.WindowApi.openDialog),d=s.WindowApi.closeDialog,f=(0,o.Z)((0,o.Z)({},p.default),{},{$ref:"#/definitions/cron_add"}),m="dialog_"+Date.now(),v=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("save_newdata=",n),(t=w.cron_list.list).push({cron:n.cron,script:"/app/cron/".concat(n.script)}),e.next=5,w.save_cron();case 5:w.cron_list.set("list",t),d(m);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),g=function(){var e=(0,c.useRef)(null);return(0,x.jsxs)(u.default,{width:"fit-content",children:[(0,x.jsx)("div",{type:"title",children:n}),(0,x.jsx)("div",{type:"content",children:(0,x.jsx)(h.default,{schema:f,ref:e,data:t})}),(0,x.jsx)(l.default,{type:"action",className:"button success",onClick:function(){var n=e.current.getValue();v(n)},children:"\u4fdd\u5b58"}),(0,x.jsx)("button",{type:"action",className:"button js-dialog-close",children:"\u5173\u95ed"})]})};r({id:m,content:(0,x.jsx)(g,{id:m})})},cron_list:(0,m.context_value.make_watch_data)({list:[]}),Render:function(e){0==w.cron_list.list.length&&w.load_cron();var n=function(){var e=(0,c.useState)(0),n=(0,r.Z)(e,2),t=n[0],o=n[1];(0,c.useEffect)((function(){var e=w.cron_list.watch("list",(function(){console.log("change!!!!",t),o(t+1)}));return function(){w.cron_list.unwatch("list",e)}})),console.log("list==",w.cron_list,w.cron_list.get("list"));var a=w.cron_list.list,i=function(e){var n=e.row;return(0,x.jsxs)("div",{className:"dropdown-button",children:[(0,x.jsx)(l.default,{className:"button dropdown-toggle",style:{width:"fit-content"},children:"\u64cd\u4f5c"}),(0,x.jsxs)("ul",{className:"d-menu","data-role":"dropdown",children:[(0,x.jsx)("li",{children:(0,x.jsx)(l.default,{className:"button success",onClick:function(){!function(e){g.config_file({filename:e.script,op:"get"}).then((function(n){w.CronScriptEdit({filename:e.script,data:n,cron:e.cron})})).catch((function(n){w.CronScriptEdit({filename:e.script,data:"#!/bin/bash\n",cron:e.cron})}))}(n)},children:"\u7f16\u8f91"})}),(0,x.jsx)("li",{children:(0,x.jsx)(l.default,{className:"button alert",onClick:function(){!function(e){w.CronScriptRemove({filename:e.script,cron:e.cron})}(n)},children:"\u5220\u9664"})})]})]})};return(0,x.jsxs)(d.default,{data:a,children:[(0,x.jsx)(d.default.TableColumn,{lable:"\u7f16\u8f91",children:(0,x.jsx)(f.default,{"slot-scope":"{row}",children:(0,x.jsx)(i,{})})}),(0,x.jsx)(d.default.TableColumn,{label:"\u5b9a\u65f6\u5668",prop:"cron"}),(0,x.jsx)(d.default.TableColumn,{label:"\u811a\u672c",prop:"script"})]})};return(0,x.jsxs)("div",{style:{height:"100%"},children:[(0,x.jsx)(l.default,{className:"button success",onClick:function(){w.CronDialog({title:"\u6dfb\u52a0\u4efb\u52a1",data:{}})},children:"\u6dfb\u52a0"}),(0,x.jsx)(l.default,{className:"button success",onClick:function(){},children:"\u6dfb\u52a0\u9ed8\u8ba4\u4efb\u52a1"}),(0,x.jsx)(n,{})]})}};n.default=w},5548:function(e,n,t){t.r(n);var r=t(37762),o=t(29439),a=t(74165),i=t(15861),c=t(1413),s=t(47313),l=t(69393),u=t(63469),d=t(63705),f=t(84724),p=t(37982),m=t(66109),v=(t(94536),t(47610)),h=t(46817),x=t(60786),g=(t(66641),t(60270)),w=(t(147),t(46417)),b=p.context_value.global_data,j=p.context_value.api,Z={check_ventory:function(){var e=b.get("blockdevices",[]);return e?e.filter((function(e){var n=e.children;if(n&&n.filter((function(e){return"Ventoy"==e.label}))[0])return!0;return!1})):null},ventoy:{ReplaceBoot:function(e){var n=(0,l.useWindowManager)(),t=(n.windows,n.getApps,n.openWindow,n.set_window_ref,n.openDialog,n.closeDialog),r=(0,s.useRef)(null),o=(0,c.Z)((0,c.Z)({},f.default),{},{$ref:"#/definitions/bootconfig"}),u=function(){var n=(0,i.Z)((0,a.Z)().mark((function n(){var o,i,c,s;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r.current.getValue(),i=e.conf_replace,c={},!i.new){n.next=9;break}return n.next=6,j.config_file({filename:"/tmp/ventoy".concat(i.new),op:"put",data:o});case 6:return n.sent,t(e.id),n.abrupt("return");case 9:return(s=e.ventoy_config).conf_replace||(s.conf_replace=[]),n.next=13,j.run_command({command:"mkdir",args:["-p","/tmp/ventoy/data"]});case 13:return c.new="/data/live_mynas.cfg",c.org="/isolinux/live.cfg",c.iso=i.iso,n.next=18,j.config_file({filename:"/tmp/ventoy".concat(c.new),op:"put",data:o});case 18:return s.conf_replace.push(c),n.next=21,j.config_file({filename:"/tmp/ventoy/ventoy/ventoy.json",op:"put",data:JSON.stringify(s)});case 21:t(e.id);case 22:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,w.jsxs)(d.default,{id:e.id,children:[(0,w.jsx)("div",{type:"title"}),(0,w.jsx)("div",{type:"content",children:(0,w.jsx)(h.default,{schema:o,ref:r,data:e.data,style:{width:"100vh",height:"100%"}})}),(0,w.jsx)("button",{type:"action",className:"button warning",onClick:u,children:"\u786e\u5b9a"}),(0,w.jsx)("button",{type:"action",className:"button js-dialog-close",children:"\u53d6\u6d88"})]})},ConfigVentoy:function(e){var n=(0,l.useWindowManager)(),t=(n.windows,n.getApps,n.openWindow,n.set_window_ref,n.openDialog,n.closeDialog),r=(0,s.useRef)(null),u=(0,s.useState)(0),p=(0,o.Z)(u,2),m=(p[0],p[1],(0,c.Z)((0,c.Z)({},f.default),{},{$ref:"#/definitions/ventoy"})),v=function(){var n=(0,i.Z)((0,a.Z)().mark((function n(){var o,i;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=r.current.getValue(),(i=JSON.parse(o))&&(a=i,j.config_file({filename:"/tmp/ventoy/ventoy/ventoy.config",op:"put",data:JSON.stringify(a)}).then((function(n){0==n.ret&&t(e.id)})));case 3:case"end":return n.stop()}var a}),n)})));return function(){return n.apply(this,arguments)}}();return(0,w.jsxs)(d.default,{id:e.id,children:[(0,w.jsx)("div",{type:"title"}),(0,w.jsx)("div",{type:"content",children:(0,w.jsx)(h.default,{schema:m,ref:r,data:e.data,style:{width:"100vh",height:"100%"}})}),(0,w.jsx)("button",{type:"action",className:"button warning",onClick:v,children:"\u786e\u5b9a"}),(0,w.jsx)("button",{type:"action",className:"button js-dialog-close",children:"\u53d6\u6d88"})]})}},download:function(e,n){j.download_file({filename:e,op:"get"}).then((function(e){console.log("resp==",e);var t=n,r=new Blob([e.data],{type:e.headers["content-type"]});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,t);else{var o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}))},BackupDialog:function(e){var n=(0,s.useRef)(null),t=(0,s.useRef)(null),r=(0,s.useState)(""),a=(0,o.Z)(r,2);a[0],a[1];return(0,s.useEffect)((function(){setTimeout((function(){n.current=new x.Terminal({rows:40,convertEol:!0,scrollback:10,disableStdin:!1,cursorStyle:"underline",cursorBlink:!0});var r=new g.FitAddon;n.current.loadAddon(r),n.current.onResize((function(e){r.fit()})),n.current.open(t.current),m.default.long_cmd({command:"7zr",args:["a","-t7z","/tmp/backup.7z","/etc/","/app/"]},{stdout:function(e){n.current&&n.current.write(e)},onend:function(){e.onEnd&&e.onEnd()}})}),100)})),(0,w.jsxs)(d.default,{children:[(0,w.jsx)("div",{type:"title",children:"\u538b\u7f29\u4e2d"}),(0,w.jsx)("div",{type:"content",ref:t,width:"100%",height:"100%"})]})},VentoySetting:function(e){var n=(0,l.useWindowManager)(),t=(n.windows,n.getApps,n.openWindow,n.set_window_ref,n.openDialog),r=e.data.children.filter((function(e){return"Ventoy"==e.label}))[0],d=(0,p.rix_make_watch_data)((0,c.Z)((0,c.Z)({},r),{},{mounted:!1})),f=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.run_command({command:"bash",args:["-c","mount | grep /tmp/ventoy"]});case 2:""==e.sent.data.stdout?d.set("mounted",!1):d.set("mounted",!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){f()}));var m=function(){var e=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.run_command({command:"mkdir",args:["-p","/tmp/ventoy"]});case 2:return e.next=4,j.run_command({command:"mount",args:[d.path,"/tmp/ventoy"]});case 4:e.sent,f();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.run_command({command:"umount",args:["/tmp/ventoy"]});case 2:e.sent,f();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=(0,s.useState)(0),r=(0,o.Z)(t,2),c=r[0],l=r[1];return(0,s.useEffect)((function(){d.watch("mounted",(function(){l(c+1)}));return function(){d.unwatch("mounted")}})),d.mounted?(0,w.jsx)(u.default,{className:"button success",onClick:n,children:"\u5378\u8f7d"}):(0,w.jsx)(u.default,{className:"button success",onClick:e,children:"\u4f7f\u7528"})},h=function(){var e=(0,s.useState)(0),n=(0,o.Z)(e,2),r=n[0],c=n[1];(0,s.useEffect)((function(){d.watch("mounted",(function(){c(r+1)}));return function(){d.unwatch("mounted")}}));var l=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var n,r,o,i,c,s,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.config_file({filename:"/tmp/ventoy/ventoy/ventoy.json",op:"get"});case 2:if(n=e.sent,r={},n&&n.conf_replace&&(o=n.conf_replace.filter((function(e){return!!e.iso.endsWith("live-image-amd64.hybrid.iso")}))[0])&&(r=o),r.iso){e.next=10;break}return e.next=8,j.run_command({command:"find",args:["/tmp/ventoy -type f -name live-image-amd64.hybrid.iso"]});case 8:0==(i=e.sent).ret&&""!=i.data.stdout&&(r.iso=i.data.stdout);case 10:if(console.log("conf_replace==",r),r.iso){e.next=13;break}return e.abrupt("return");case 13:if(c="\nlabel live-rix-with-persistence-encryption\n        menu label ^Live system (rix) without persistence-encryption\n        linux /live/vmlinuz\n        initrd /live/initrd.img\n        append boot=live components persistence persistence-encryption=luks persistence-label=mynas quiet splash pci=noaer pcie_aspm=off ip=frommedia\nlabel live-rix\n        menu label ^Live system (rix)\n        menu default\n        linux /live/vmlinuz\n        initrd /live/initrd.img\n        append boot=live components persistence persistence-label=mynas quiet splash pci=noaer pcie_aspm=off ip=frommedia\n\nlabel live-rix-failsafe\n        menu label Live system (rix fail-safe mode)\n        linux /live/vmlinuz\n        initrd /live/initrd.img\n        append boot=live components memtest noapic noapm nodma nomce nolapic nosmp nosplash vga=788\n",!r.new){e.next=19;break}return e.next=17,j.config_file({filename:"/tmp/ventoy".concat(r.new),op:"get"});case 17:(s=e.sent)&&!s.ret&&(c=s);case 19:l="dialog_"+Date.now(),t({id:l,content:(0,w.jsx)(Z.ventoy.ReplaceBoot,{id:l,data:c,conf_replace:r,ventoy_config:n})});case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return d.mounted?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.default,{className:"button success",children:"\u521b\u5efapersestenc\u955c\u50cf"}),(0,w.jsx)(u.default,{className:"button success",children:"\u914d\u7f6e\u6302\u8f7dpersestenc\u955c\u50cf"}),(0,w.jsx)(u.default,{className:"button success",onClick:l,children:"\u914d\u7f6e\u542f\u52a8\u6587\u4ef6"}),(0,w.jsx)(u.default,{className:"button success",onClick:function(){var e=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var n,r,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.config_file({filename:"/tmp/ventoy/ventoy/ventoy.json",op:"get"});case 2:n=e.sent;try{n&&!n.ret&&(console.log("update config==",n),r=JSON.stringify(n,null,2),o="dialog_"+Date.now(),t({id:o,content:(0,w.jsx)(Z.ventoy.ConfigVentoy,{id:o,data:r})}))}catch(a){}case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()},children:"\u914d\u7f6eventoy"})]}):(0,w.jsx)(w.Fragment,{children:"\u5148\u6302\u8f7d\u624d\u80fd\u914d\u7f6e"})};return(0,w.jsxs)(v.default,{collapsible:!0,children:[(0,w.jsxs)("div",{type:"title",children:["ventory\u914d\u7f6e \u8bbe\u5907:",e.data.path," \u5927\u5c0f:",e.data.size]}),(0,w.jsx)(m,{type:"button"}),(0,w.jsx)("div",{className:"w-100",style:{display:"flex",justifyContent:"space-around"},children:(0,w.jsx)(h,{})})]})},Setting:function(){var e=(0,l.useWindowManager)(),n=(e.windows,e.getApps,e.openWindow,e.set_window_ref,e.openDialog),t=(0,p.rix_make_watch_data)({ventoy:[]});(0,s.useEffect)((function(){var e=Z.check_ventory();t.set("ventoy",e);b.watch("blockdevices",(function(){var e=Z.check_ventory();t.set("ventoy",e)}));return function(){b.unwatch("blockdevices")}}));var a=function(){var e=(0,s.useState)(0),n=(0,o.Z)(e,2),a=n[0],i=n[1];(0,s.useEffect)((function(){var e=t.watch("ventoy",(function(){i(a+1)}));return function(){t.unwatch(e)}}));var c,l=[],u=(0,r.Z)(t.ventoy);try{for(u.s();!(c=u.n()).done;){var d=c.value;l.push((0,w.jsx)(s.Fragment,{children:(0,w.jsx)(Z.VentoySetting,{data:d})},d.path))}}catch(f){u.e(f)}finally{u.f()}return l};return(0,w.jsxs)("div",{children:["\u5907\u4efd\u670d\u52a1\u5668\u914d\u7f6e",(0,w.jsx)(u.default,{className:"button success",onClick:function(){var e="dialog_"+Date.now();n({id:e,content:(0,w.jsx)(Z.BackupDialog,{onEnd:function(){Z.download("/tmp/backup.7z","backup.7z")}})})},children:"\u5907\u4efd"}),(0,w.jsx)(a,{})]})}};n.default=Z},71547:function(e,n,t){t.r(n);var r=t(29439),o=t(1413),a=t(74165),i=t(15861),c=t(47313),s=t(69393),l=t(63469),u=t(63705),d=(t(47610),t(86385),t(56659),t(84724)),f=t(37982),p=(t(66109),t(94536),t(46817)),m=(t(60786),t(66641),t(60270),t(147),t(70816)),v=t.n(m),h=t(56573),x=t(46417),g=(f.context_value.global_data,f.context_value.api),w={config:(0,f.context_value.make_watch_data)({config:{}}),get_config:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.config_file({filename:"/app/config.json",op:"get"});case 3:return n=e.sent,w.config.set("config",n),console.log("set config====",n,w.config),e.abrupt("return",n);case 9:return e.prev=9,e.t0=e.catch(0),console.log("error===",e.t0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},save_config:function(e){return(0,i.Z)((0,a.Z)().mark((function n(){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.config_file({op:"put",filename:"/app/config.json",data:JSON.stringify(e,null,2)});case 2:return n.next=4,w.get_config();case 4:case"end":return n.stop()}}),n)})))()},test_mail:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.Z.post("/api/notify",{subject:"this is  for test notify from web at ".concat(v()()),message:"test in system control \u8fd9\u4e2a\u662f\u4e2d\u6587\u4ee5\u53ca\u8868\u60c5\u7b26\u53f7 \ud83c\udf39",attach:"/app/test.sh"});case 2:n=e.sent,console.log("send_ret==",n);case 4:case"end":return e.stop()}}),e)})))()},edit_auto_start:function(){return(0,i.Z)((0,a.Z)().mark((function e(){var n,t,r,i,l,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/app/scripts/auto_start.sh",e.next=3,g.config_file({filename:n,op:"get"});case 3:t=e.sent,s.WindowApi.windows,s.WindowApi.getApps,s.WindowApi.openWindow,s.WindowApi.set_window_ref,r=s.WindowApi.openDialog,i=s.WindowApi.closeDialog,l="dialog_"+Date.now(),f=function(e){var r=(0,c.useRef)(null),a=(0,o.Z)((0,o.Z)({},d.default),{},{$ref:"#/definitions/sh_script"});return(0,x.jsxs)(u.default,{className:"w-100",id:e.id,children:[(0,x.jsx)("div",{type:"title",children:"\u81ea\u52a8\u542f\u52a8\u914d\u7f6e"}),(0,x.jsx)("div",{type:"content",className:"w-100",children:(0,x.jsx)(p.default,{schema:a,ref:r,data:t})}),(0,x.jsx)("button",{type:"action",className:"button success",onClick:function(){var e=r.current.getValue();g.config_file({filename:n,op:"put",data:e}),i(l)},children:" \u4fdd\u5b58 "}),(0,x.jsx)("button",{type:"action",className:"button js-dialog-close",children:" \u5173\u95ed "})]})},r({id:l,content:(0,x.jsx)(f,{id:l})});case 8:case"end":return e.stop()}}),e)})))()},Setting:function(e){var n=(0,c.useState)(0),t=(0,r.Z)(n,2),s=t[0],u=t[1];(0,c.useEffect)((function(){var e=w.config.watch("config",(function(){console.log("config update!!!!"),u(s+1)}));return function(){w.config.unwatch("config",e)}}));var f=(0,o.Z)((0,o.Z)({},d.default),{},{$ref:"#/definitions/system_settings"}),m=w.config.config;console.log("system.config==",w.config);var v=(0,c.useRef)(null),h=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=v.current.getValue(),w.save_config(n);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w.test_mail();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,x.jsxs)("div",{className:"w-100 h-100",children:[(0,x.jsx)("div",{type:"content",children:(0,x.jsx)(p.default,{schema:f,ref:v,data:m})}),(0,x.jsx)(l.default,{type:"action",className:"button success",onClick:g,children:"\u6d4b\u8bd5\u901a\u77e5"}),(0,x.jsx)(l.default,{type:"action",className:"button success",onClick:h,children:"\u4fdd\u5b58"}),(0,x.jsx)(l.default,{type:"action",className:"button success",onClick:function(){w.edit_auto_start()},children:"\u7f16\u8f91\u81ea\u52a8\u542f\u52a8\u811a\u672c"}),(0,x.jsx)("button",{type:"action",className:"button js-dialog-close",children:"\u5173\u95ed"})]})},Render:function(e){return w.get_config(),(0,x.jsx)(w.Setting,(0,o.Z)({},e))}};n.default=w},8586:function(e,n,t){var r=t(81171),o=t(46417);n.Z=(0,r.Z)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},36555:function(e,n,t){var r=t(81171),o=t(46417);n.Z=(0,r.Z)((0,o.jsx)("path",{d:"M3 3h18v2H3z"}),"Maximize")},24272:function(e,n,t){var r=t(81171),o=t(46417);n.Z=(0,r.Z)((0,o.jsx)("path",{d:"M6 19h12v2H6z"}),"Minimize")},96944:function(e,n,t){var r=t(81171),o=t(46417);n.Z=(0,r.Z)((0,o.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"Restore")},75908:function(e,n,t){t.d(n,{Z:function(){return w}});var r=t(63366),o=t(87462),a=t(47313),i=t(83061),c=t(21921),s=t(17592),l=t(77342),u=t(91615),d=t(70501),f=t(77430),p=t(32298);function m(e){return(0,p.Z)("MuiAppBar",e)}(0,f.Z)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);var v=t(46417),h=["className","color","enableColorOnDark","position"],x=function(e,n){return e?"".concat(null==e?void 0:e.replace(")",""),", ").concat(n,")"):n},g=(0,s.ZP)(d.Z,{name:"MuiAppBar",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,n["position".concat((0,u.Z)(t.position))],n["color".concat((0,u.Z)(t.color))]]}})((function(e){var n=e.theme,t=e.ownerState,r="light"===n.palette.mode?n.palette.grey[100]:n.palette.grey[900];return(0,o.Z)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===t.position&&{position:"fixed",zIndex:(n.vars||n).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===t.position&&{position:"absolute",zIndex:(n.vars||n).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===t.position&&{position:"sticky",zIndex:(n.vars||n).zIndex.appBar,top:0,left:"auto",right:0},"static"===t.position&&{position:"static"},"relative"===t.position&&{position:"relative"},!n.vars&&(0,o.Z)({},"default"===t.color&&{backgroundColor:r,color:n.palette.getContrastText(r)},t.color&&"default"!==t.color&&"inherit"!==t.color&&"transparent"!==t.color&&{backgroundColor:n.palette[t.color].main,color:n.palette[t.color].contrastText},"inherit"===t.color&&{color:"inherit"},"dark"===n.palette.mode&&!t.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===t.color&&(0,o.Z)({backgroundColor:"transparent",color:"inherit"},"dark"===n.palette.mode&&{backgroundImage:"none"})),n.vars&&(0,o.Z)({},"default"===t.color&&{"--AppBar-background":t.enableColorOnDark?n.vars.palette.AppBar.defaultBg:x(n.vars.palette.AppBar.darkBg,n.vars.palette.AppBar.defaultBg),"--AppBar-color":t.enableColorOnDark?n.vars.palette.text.primary:x(n.vars.palette.AppBar.darkColor,n.vars.palette.text.primary)},t.color&&!t.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":t.enableColorOnDark?n.vars.palette[t.color].main:x(n.vars.palette.AppBar.darkBg,n.vars.palette[t.color].main),"--AppBar-color":t.enableColorOnDark?n.vars.palette[t.color].contrastText:x(n.vars.palette.AppBar.darkColor,n.vars.palette[t.color].contrastText)},{backgroundColor:"var(--AppBar-background)",color:"inherit"===t.color?"inherit":"var(--AppBar-color)"},"transparent"===t.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),w=a.forwardRef((function(e,n){var t=(0,l.Z)({props:e,name:"MuiAppBar"}),a=t.className,s=t.color,d=void 0===s?"primary":s,f=t.enableColorOnDark,p=void 0!==f&&f,x=t.position,w=void 0===x?"fixed":x,b=(0,r.Z)(t,h),j=(0,o.Z)({},t,{color:d,position:w,enableColorOnDark:p}),Z=function(e){var n=e.color,t=e.position,r=e.classes,o={root:["root","color".concat((0,u.Z)(n)),"position".concat((0,u.Z)(t))]};return(0,c.Z)(o,m,r)}(j);return(0,v.jsx)(g,(0,o.Z)({square:!0,component:"header",ownerState:j,elevation:4,className:(0,i.default)(Z.root,a,"fixed"===w&&"mui-fixed"),ref:n},b))}))},9289:function(e,n,t){t.d(n,{Z:function(){return x}});var r=t(4942),o=t(63366),a=t(87462),i=t(47313),c=t(83061),s=t(21921),l=t(77342),u=t(17592),d=t(77430),f=t(32298);function p(e){return(0,f.Z)("MuiToolbar",e)}(0,d.Z)("MuiToolbar",["root","gutters","regular","dense"]);var m=t(46417),v=["className","component","disableGutters","variant"],h=(0,u.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,!t.disableGutters&&n.gutters,n[t.variant]]}})((function(e){var n=e.theme,t=e.ownerState;return(0,a.Z)({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&(0,r.Z)({paddingLeft:n.spacing(2),paddingRight:n.spacing(2)},n.breakpoints.up("sm"),{paddingLeft:n.spacing(3),paddingRight:n.spacing(3)}),"dense"===t.variant&&{minHeight:48})}),(function(e){var n=e.theme;return"regular"===e.ownerState.variant&&n.mixins.toolbar})),x=i.forwardRef((function(e,n){var t=(0,l.Z)({props:e,name:"MuiToolbar"}),r=t.className,i=t.component,u=void 0===i?"div":i,d=t.disableGutters,f=void 0!==d&&d,x=t.variant,g=void 0===x?"regular":x,w=(0,o.Z)(t,v),b=(0,a.Z)({},t,{component:u,disableGutters:f,variant:g}),j=function(e){var n=e.classes,t={root:["root",!e.disableGutters&&"gutters",e.variant]};return(0,s.Z)(t,p,n)}(b);return(0,m.jsx)(h,(0,a.Z)({as:u,className:(0,c.default)(j.root,r),ref:n,ownerState:b},w))}))}}]);