"use strict";(self.webpackChunkmypxe_admin=self.webpackChunkmypxe_admin||[]).push([[329,118],{16118:function(e,t,n){n.r(t);var r=n(1413),s=n(70885),a=n(15671),i=n(43144),u=n(60136),o=n(98557),c=n(72791),l=n(1250),d=n(28714),h=n(19935),p=n(19218),f=n(80184),v=window.JSONEditor,m=function(e){(0,u.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"build",value:function(){var e=this,t=(this.value,this);this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle(),this.isRequired()),this.container.appendChild(this.title);var n=this.options.disks;this.disks=n;var a=document.createElement("div");this.container.append(a),this.view_root=l.createRoot(a),this.rix_init_flag=!1;var i=function(t,n){t.preventDefault(),e.setValue(n,!1,!1)};if(this.used_disks=(0,d.rix_make_watch_data)({used:[],cur_path:""}),this.parent.parent&&this.parent.parent.schema.uniqueItems){var u=this.parent.parent;this.jsoneditor.watch(u.path,(function(){var t=u.getValue().map((function(e){return e.path}));e.used_disks.set("used",t)}))}this.set_model=function(e){if(t.parent&&t.parent.jsoneditor){var n=t.parent.jsoneditor.getEditor(t.parent.path+".model");if(n&&t.disks){var r=e,s=t.disks.filter((function(e){return e.path==r}))[0];s&&n.setValue(s.model)}}},this.used_disks.watch("cur_path",this.set_model);var o=this.defaults.global_data,v=function(){var t=(0,c.useState)([]),a=(0,s.Z)(t,2),u=a[0],l=a[1],d=(0,c.useState)(""),v=(0,s.Z)(d,2),m=v[0],Z=v[1];return n||(n=o.get("blockdevices")),e.disks=n,(0,c.useEffect)((function(){var t=function(e){var t=n.map((function(e){return e.path}));t=t.filter((function(t){return 0==e.filter((function(e){return e==t})).length})),l(t)};e.used_disks.watch("used",t);var r;return t(e.used_disks.get("used")),r=e.used_disks.get("cur_path"),Z(r),e.set_model(r),function(){e.used_disks.unwatch("used",t)}}),[]),(0,f.jsx)(h.Z,{freeSolo:!0,value:m,onChange:i,options:u,getOptionLabel:function(e){var t=n.filter((function(t){return t.path==e}))[0];return t?"".concat(t.model,"(").concat(t.size,") at ").concat(t.path):""},renderInput:function(e){return(0,f.jsx)(p.Z,(0,r.Z)((0,r.Z)({},e),{},{label:"\u9009\u62e9\u78c1\u76d8"}))}})};this.view_root.render((0,f.jsx)(v,{}))}},{key:"setValue",value:function(e,t,n){this.value=e,this.refreshValue(),this.used_disks.set("cur_path",e),this.onChange(!0)}},{key:"getValue",value:function(){return this.value}},{key:"destroy",value:function(){var e=this;this.used_disks.unwatch(this.set_model),setTimeout((function(){e.view_root.unmount()}))}}]),n}(v.AbstractEditor),Z=(0,c.forwardRef)((function(e,t){var n=e.schema,s=(e.callbacks,(0,c.useRef)(null)),a=(0,c.useRef)(null),i=(0,d.useData)().global_data;v.defaults.editors.disk_select=m,v.defaults.global_data=i,v.defaults.resolvers.unshift((function(e){if("string"===e.type&&"disk_select"===e.format)return"disk_select"})),(0,c.useEffect)((function(){var t=(0,r.Z)({schema:n,theme:"bootstrap4"},e.options);return s.current=new v(a.current,t),s.current.on("ready",(function(){e.data&&s.current.setValue(e.data)})),function(){s.current&&s.current.destroy()}}),[n,e]);var u=function(){return s.current.getValue()};return(0,c.useImperativeHandle)(t,(function(){return{getValue:u}})),(0,f.jsx)("div",(0,r.Z)({ref:a},e))}));t.default=Z},72329:function(e,t,n){n.r(t);var r=n(1413),s=n(74165),a=n(15861),i=n(70885),u=n(72791),o=n(11687),c=n(16118),l=n(99059),d=n(39157),h=n(5289),p=n(65661),f=n(97123),v=n(36151),m=n(19218),Z=n(39281),k=n(35527),x=n(79836),y=n(56890),g=n(35855),j=n(53994),_=n(53382),b=n(89341),w=n(80184);t.default=function(){var e=(0,u.useState)([]),t=(0,i.Z)(e,2),n=t[0],S=t[1],C=(0,u.useState)({id:0,key:"",status:0,type:0,value:"",parent_id:0}),E=(0,i.Z)(C,2),V=E[0],P=E[1],O=(0,u.useState)(!0),R=(0,i.Z)(O,2),T=(R[0],R[1],(0,u.useState)(0)),I=(0,i.Z)(T,2),L=I[0],q=I[1],A=(0,u.useState)(10),D=(0,i.Z)(A,2),F=D[0],N=D[1],z=(0,u.useState)(""),J=(0,i.Z)(z,2),W=J[0],B=J[1],H=(0,u.useState)({type:"object",properties:{id:{type:"integer",title:"ID",readonly:!0},key:{type:"string",title:"Key"},status:{type:"integer",title:"Status",enum:[0,1],options:{enum_titles:["Not available","Available"]}},type:{type:"integer",title:"Type",enum:[0,1,2,3,4],options:{enum_titles:["json","string","number","bool","null"]}},parent_id:{type:"integer",title:"parent_id"},value:{type:"string",title:"Value",format:"json",options:{ace:{theme:"ace/theme/vibrant_ink",tabSize:2,useSoftTabs:!0}}}},required:["key","type","value","parent_id","id","status"]}),K=(0,i.Z)(H,2),$=K[0],G=K[1],M=(0,u.useState)(!1),Q=(0,i.Z)(M,2),U=Q[0],X=Q[1],Y=(0,u.useState)({key:"",value:"",type:"",status:""}),ee=(0,i.Z)(Y,2);ee[0],ee[1];(0,u.useEffect)((function(){re()}),[]);var te=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this parameter?")){e.next=11;break}return e.prev=1,e.next=4,o.default.deleteParameter({op:"delete",data:{id:t}});case 4:(n=e.sent).ok?re():console.error("Error deleting parameter:",n.statusText),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error deleting parameter:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),ne=(0,u.useRef)(null),re=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.default.getParameters(W);case 2:t=e.sent,S(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=n.filter((function(e){return Object.values(e).some((function(e){return e.toString().toLowerCase().includes(W.toLowerCase())}))})),ae={},ie=function(){X(!1)},ue=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=ne.current.getValue(),e.next=4,o.default.addParameter((0,r.Z)({},t));case 4:(n=e.sent).ok?(re(),X(!1)):console.error("Error saving parameter:",n.statusText),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error saving parameter:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),oe=(0,l.Z)(d.Z)({width:"80%"});for(var ce in n){var le=n[ce];if(0!=le.status)switch(le.type){case 4:ae[le.key]=null;break;case 0:try{ae[le.key]=JSON.parse(le.value)}catch(he){ae[le.key]=le.value}break;default:ae[le.key]=le.value}}var de=function(e){var t=e.value;if(t.indexOf("${")>=0&&1==e.type)try{var n=Object.keys(ae).join(","),r=new Function(n,'"use strict"; return `'.concat(t,"`;")),s=Object.values(ae);return r.apply(void 0,s)}catch(he){return t}return t};return(0,w.jsxs)("div",{children:[(0,w.jsx)(m.Z,{label:"Filter",variant:"outlined",value:W,onChange:function(e){B(e.target.value)},style:{marginBottom:"1rem"}}),(0,w.jsx)(v.Z,{onClick:function(){var e=$,t=[0],r={enum_titles:[""]};for(var s in n){var a=n[s];1==a.status&&0==a.type&&(t.push(a.id),r.enum_titles.push(a.key))}console.log("obj==",ae,t),t.length>0&&(e.properties.parent_id.enum=t,e.properties.parent_id.options=r),G(e),X(!0)},children:"\u6dfb\u52a0"}),(0,w.jsxs)(h.Z,{open:U,onClose:ie,fullWidth:!0,maxWidth:"md",children:[(0,w.jsx)(p.Z,{children:"\u6dfb\u52a0\u53c2\u6570"}),(0,w.jsx)(oe,{children:(0,w.jsx)(c.default,{schema:$,ref:ne,data:V})}),(0,w.jsxs)(f.Z,{children:[(0,w.jsx)(v.Z,{onClick:ue,children:"\u4fdd\u5b58"}),(0,w.jsx)(v.Z,{onClick:ie,children:"\u53d6\u6d88"})]})]}),(0,w.jsx)(Z.Z,{component:k.Z,children:(0,w.jsxs)(x.Z,{children:[(0,w.jsx)(y.Z,{children:(0,w.jsxs)(g.Z,{children:[(0,w.jsx)(j.Z,{children:"\u8bbe\u5907"}),(0,w.jsx)(j.Z,{children:"\u6807\u8bc6"}),(0,w.jsx)(j.Z,{children:"\u6e29\u5ea6"}),(0,w.jsx)(j.Z,{children:"\u8bfb\u53d6"}),(0,w.jsx)(j.Z,{children:"\u5199\u5165"}),(0,w.jsx)(j.Z,{children:"\u9519\u8bef"})]})}),(0,w.jsx)(_.Z,{children:se.slice(L*F,L*F+F).map((function(e){return(0,w.jsxs)(g.Z,{children:[(0,w.jsxs)(j.Z,{children:[(0,w.jsx)(v.Z,{onClick:function(){return P(e),console.log("data====",V),void X(!0)},children:"\u7f16\u8f91"}),(0,w.jsx)(v.Z,{onClick:function(){return te(e.id)},children:"\u5220\u9664"})]}),(0,w.jsx)(j.Z,{children:e.id}),(0,w.jsx)(j.Z,{children:e.key}),(0,w.jsx)(j.Z,{children:de(e)}),(0,w.jsx)(j.Z,{children:e.type}),(0,w.jsx)(j.Z,{children:e.status})]},e.id)}))})]})}),(0,w.jsx)(b.Z,{component:"div",count:se.length,page:L,onPageChange:function(e,t){q(t)},rowsPerPage:F,onRowsPerPageChange:function(e){N(parseInt(e.target.value,10)),q(0)},style:{marginTop:"1rem"}})]})}}}]);
//# sourceMappingURL=329.47ab5ea0.chunk.js.map