"use strict";(self.webpackChunkmypxe_admin=self.webpackChunkmypxe_admin||[]).push([[569,8],{89008:function(n,e,t){t.r(e);var r=t(37762),a=t(93433),s=t(1413),u=t(29439),c=t(47313),i=t(51629),o=t(70501),l=t(66835),d=t(23477),f=t(24076),h=t(67478),p=t(57861),Z=t(69099),x=t(99783),v=t(37982),m=t(46417);e.default=function(n){var e=(0,v.useData)(),t=e.global_data,j=(e.api,(0,c.useState)([])),k=(0,u.Z)(j,2),_=k[0],g=(k[1],(0,c.useState)(!0)),w=(0,u.Z)(g,2),b=(w[0],w[1],(0,c.useState)(0)),y=(0,u.Z)(b,2),C=y[0],S=y[1],D=(0,c.useState)(10),I=(0,u.Z)(D,2),P=I[0],E=I[1],R=(0,c.useState)({online:!1,status_text:"\u79bb\u7ebf"}),A=(0,u.Z)(R,2),z=(A[0],A[1],(0,c.useState)({data:[],disks:n.data||[]})),B=(0,u.Z)(z,2),L=B[0],O=B[1],T=function(n){O((function(e){return(0,s.Z)((0,s.Z)({},e),n)}))},F=(0,c.useState)(""),H=(0,u.Z)(F,2),J=H[0],N=(H[1],L.disks.filter((function(n){return Object.values(n).some((function(n){return n.toString().toLowerCase().includes(J.toLowerCase())}))})));return(0,c.useEffect)((function(){T({disks:n.data});t.get("blockdevices");var e=function(e){var u,c=t.get("blockdevices"),i=_,o=(0,a.Z)(L.disks),l=(0,r.Z)(n.data);try{var d=function(){var n=u.value,e=o.findIndex((function(e){return e.path==n.path}));e<0&&o.push(n)};for(l.s();!(u=l.n()).done;)d()}catch(h){l.e(h)}finally{l.f()}var f=e;i.forEach((function(n){var e=f.filter((function(e){return n.path=="/dev/".concat(e.Device)}))[0];if(c){var t=c.filter((function(e){return e.path===n.path}))[0];if(e&&t){var r=o.findIndex((function(e){return e.path==n.path}));r>=0?o.splice(r,1,(0,s.Z)((0,s.Z)({},t),{},{id:n.path},e)):o.push((0,s.Z)((0,s.Z)({},t),{},{id:n.path},e))}}})),T({disks:(0,a.Z)(o)})};return t.watch("sysstat",e),function(){t.unwatch("sysstat",e)}}),[n.data]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i.Z,{component:o.Z,children:(0,m.jsxs)(l.Z,{children:[(0,m.jsx)(d.Z,{children:(0,m.jsxs)(f.Z,{children:[(0,m.jsx)(h.Z,{children:"\u8bbe\u5907"}),(0,m.jsx)(h.Z,{children:"PATH"}),(0,m.jsx)(h.Z,{children:"\u6807\u8bc6"}),(0,m.jsx)(h.Z,{children:"\u5bb9\u91cf"}),(0,m.jsx)(h.Z,{children:"\u8bfb\u53d6"}),(0,m.jsx)(h.Z,{children:"\u5199\u5165"})]})}),(0,m.jsx)(p.Z,{children:N.slice(C*P,C*P+P).map((function(e){return(0,m.jsxs)(f.Z,{children:[(0,m.jsxs)(h.Z,{children:[n.onDown&&(0,m.jsx)(Z.Z,{onClick:function(){return n.onDown(e)},children:"\u4e0b\u7ebf"}),n.onAdd&&n.check_add_status&&n.check_add_status(e)&&(0,m.jsx)(Z.Z,{onClick:function(){return n.onAdd(e)},children:"\u6dfb\u52a0\u5230\u6c60"}),n.onRemove&&(0,m.jsx)(Z.Z,{onClick:function(){return n.onRemove(e)},children:"\u79fb\u9664"})]}),(0,m.jsx)(h.Z,{children:e.path}),(0,m.jsxs)(h.Z,{children:[e.model," ",e.serial," ",e.size]}),(0,m.jsx)(h.Z,{children:e.size}),(0,m.jsx)(h.Z,{children:e["kB_read/s"]}),(0,m.jsx)(h.Z,{children:e["kB_wrtn/s"]})]},e.path)}))})]})}),(0,m.jsx)(x.Z,{component:"div",count:N.length,page:C,onPageChange:function(n,e){S(e)},rowsPerPage:P,onRowsPerPageChange:function(n){E(parseInt(n.target.value,10)),S(0)},style:{marginTop:"1rem"}})]})}},9569:function(n,e,t){t.r(e);var r=t(74165),a=t(15861),s=t(29439),u=t(47313),c=t(69099),i=t(71889),o=t(37982),l=t(89008),d=t(46417);e.default=function(n){var e=n.data;console.log("pool=",e);var t=(0,o.useData)(),f=t.global_data,h=t.api,p=(0,u.useState)([]),Z=(0,s.Z)(p,2),x=Z[0],v=Z[1];(0,u.useEffect)((function(){v(n.data.label)}),[n.data]);var m=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(t){var a,s;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.run_command(i.default.device.evacuate({device:t.path,mount_path:e.mount_path}));case 2:if(0!=n.sent.ret){n.next=17;break}return n.next=6,h.run_command(i.default.device.remove({device:t.path,mount_path:e.mount_path}));case 6:if(0!=n.sent.ret){n.next=17;break}return(a=e.label.findIndex((function(n){return n.path==t.path})))>=0&&e.label.splice(a,1),s=f.get("pools"),(a=s.findIndex((function(n){return n.name===e.name})))>=0&&s.splice(a,1,e),n.next=15,h.config_file({filename:"config/pools.config",op:"put",data:JSON.stringify(s)});case 15:0==n.sent.ret&&(v(e.label),f.set("pools",s));case 17:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),j=function(){var n=(0,u.useState)({online:!1,status_text:"\u79bb\u7ebf"}),t=(0,s.Z)(n,2),o=t[0],l=t[1],f=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(){var t,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.mount_path,n.next=3,h.run_command(i.default.fs.usage(t));case 3:0==(a=n.sent).ret?(a.data.stdout.split("\n"),l({online:!0,status_text:"\u5728\u7ebf"})):l({online:!1,status_text:"\u79bb\u7ebf"});case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),p=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(t){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,h.run_command(i.default.mount(e));case 3:return n.sent,n.next=6,f();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),Z=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(t){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,h.run_command(i.default.umount(e));case 3:return n.sent,n.next=6,f();case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,u.useEffect)((function(){var n=setInterval((function(){f()}),6e4);return f(),function(){clearInterval(n)}}),[]),(0,d.jsxs)("div",{children:["\u540d\u79f0:",e.name," \u6302\u8f7d\u4f4d\u7f6e: ",e.mount_path," \u72b6\u6001:",o.online&&(0,d.jsx)(c.Z,{onClick:Z,children:"\u5378\u8f7d"}),!o.online&&(0,d.jsx)(c.Z,{onClick:p,children:"\u6302\u8f7d"})]})};return(0,d.jsxs)("div",{children:[(0,d.jsx)(j,{}),(0,d.jsx)(l.default,{data:x,onDown:function(n){console.log("down==",n)},onRemove:m}),";"]})}}}]);