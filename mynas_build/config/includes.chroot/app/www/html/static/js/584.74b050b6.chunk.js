"use strict";(self.webpackChunkmypxe_admin=self.webpackChunkmypxe_admin||[]).push([[584,118,597],{55113:function(t,e,n){n.r(e);var i=n(72791),r=n(84395),a=n(34663),s=n(20890),o=n(13400),u=n(54982),c=n(45675),l=n(52118),d=n(96739),p=(n(28714),n(80184)),m=(0,i.forwardRef)((function(t,e){var n=t.onActive,i=t.onClose,m=t.onRestore,f=t.onMaximize,_=t.onMinimize;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.Z,{sx:{position:"relative"},children:(0,p.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,p.jsx)(s.Z,{variant:"h6",component:"div",sx:{flexGrow:1,cursor:"move"},className:"window-title",onClick:n,children:t.title}),(0,p.jsx)(o.Z,{color:"inherit",onClick:_,children:(0,p.jsx)(u.Z,{})}),t.isMaximized?(0,p.jsx)(o.Z,{color:"inherit",onClick:m,children:(0,p.jsx)(c.Z,{})}):(0,p.jsx)(o.Z,{color:"inherit",onClick:f,children:(0,p.jsx)(l.Z,{})}),(0,p.jsx)(o.Z,{color:"inherit",onClick:i,children:(0,p.jsx)(d.Z,{})})]})}),t.children]})}));e.default=m},16118:function(t,e,n){n.r(e);var i=n(1413),r=n(70885),a=n(15671),s=n(43144),o=n(60136),u=n(98557),c=n(72791),l=n(1250),d=n(28714),p=n(19935),m=n(19218),f=n(80184),_=window.JSONEditor,h=function(t){(0,o.Z)(n,t);var e=(0,u.Z)(n);function n(){return(0,a.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"build",value:function(){var t=this,e=(this.value,this);this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle(),this.isRequired()),this.container.appendChild(this.title);var n=this.options.disks;this.disks=n;var a=document.createElement("div");this.container.append(a),this.view_root=l.createRoot(a),this.rix_init_flag=!1;var s=function(e,n){e.preventDefault(),t.setValue(n,!1,!1)};if(this.used_disks=(0,d.rix_make_watch_data)({used:[],cur_path:""}),this.parent.parent&&this.parent.parent.schema.uniqueItems){var o=this.parent.parent;this.jsoneditor.watch(o.path,(function(){var e=o.getValue().map((function(t){return t.path}));t.used_disks.set("used",e)}))}this.set_model=function(t){if(e.parent&&e.parent.jsoneditor){var n=e.parent.jsoneditor.getEditor(e.parent.path+".model");if(n&&e.disks){var i=t,r=e.disks.filter((function(t){return t.path==i}))[0];r&&n.setValue(r.model)}}},this.used_disks.watch("cur_path",this.set_model);var u=this.defaults.global_data,_=function(){var e=(0,c.useState)([]),a=(0,r.Z)(e,2),o=a[0],l=a[1],d=(0,c.useState)(""),_=(0,r.Z)(d,2),h=_[0],g=_[1];return n||(n=u.get("blockdevices")),t.disks=n,(0,c.useEffect)((function(){var e=function(t){var e=n.map((function(t){return t.path}));e=e.filter((function(e){return 0==t.filter((function(t){return t==e})).length})),l(e)};t.used_disks.watch("used",e);var i;return e(t.used_disks.get("used")),i=t.used_disks.get("cur_path"),g(i),t.set_model(i),function(){t.used_disks.unwatch("used",e)}}),[]),(0,f.jsx)(p.Z,{freeSolo:!0,value:h,onChange:s,options:o,getOptionLabel:function(t){var e=n.filter((function(e){return e.path==t}))[0];return e?"".concat(e.model,"(").concat(e.size,") at ").concat(e.path):""},renderInput:function(t){return(0,f.jsx)(m.Z,(0,i.Z)((0,i.Z)({},t),{},{label:"\u9009\u62e9\u78c1\u76d8"}))}})};this.view_root.render((0,f.jsx)(_,{}))}},{key:"setValue",value:function(t,e,n){this.value=t,this.refreshValue(),this.used_disks.set("cur_path",t),this.onChange(!0)}},{key:"getValue",value:function(){return this.value}},{key:"destroy",value:function(){var t=this;this.used_disks.unwatch(this.set_model),setTimeout((function(){t.view_root.unmount()}))}}]),n}(_.AbstractEditor),g=(0,c.forwardRef)((function(t,e){var n=t.schema,r=(t.callbacks,(0,c.useRef)(null)),a=(0,c.useRef)(null),s=(0,d.useData)().global_data;_.defaults.editors.disk_select=h,_.defaults.global_data=s,_.defaults.resolvers.unshift((function(t){if("string"===t.type&&"disk_select"===t.format)return"disk_select"})),(0,c.useEffect)((function(){var e=(0,i.Z)({schema:n,theme:"bootstrap4"},t.options);return r.current=new _(a.current,e),r.current.on("ready",(function(){t.data&&r.current.setValue(t.data)})),function(){r.current&&r.current.destroy()}}),[n,t]);var o=function(){return r.current.getValue()};return(0,c.useImperativeHandle)(e,(function(){return{getValue:o}})),(0,f.jsx)("div",(0,i.Z)({ref:a},t))}));e.default=g},47448:function(t,e,n){n.r(e);var i=n(74165),r=n(15861),a=n(70885),s=n(1413),o=n(72791),u=n(39157),c=n(84395),l=n(98530),d=n(5289),p=n(65661),m=n(97123),f=n(36151),_=n(19727),h=n(99059),g=n(38597),b=n(28714),v=(n(16118),n(32699)),y=(n(86142),n(83531)),x=(n(56320),n(55113)),Z=n(80184),k=((0,h.Z)(u.Z)({width:"80%"}),(0,h.Z)("main",{shouldForwardProp:function(t){return"open"!==t}})((function(t){var e=t.theme,n=t.open;return(0,s.Z)({flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:"-".concat(240,"px")},n&&{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0})})),(0,h.Z)(c.Z,{shouldForwardProp:function(t){return"open"!==t}})((function(t){var e=t.theme,n=t.open;return(0,s.Z)({transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},n&&{width:"calc(100% - ".concat(240,"px)"),marginLeft:"".concat(240,"px"),transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})})})),(0,h.Z)("div")((function(t){var e=t.theme;return(0,s.Z)((0,s.Z)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"})})),function(t){var e=(0,o.useRef)(null),n=(0,o.useRef)(null),i=(0,o.useState)(""),r=(0,a.Z)(i,2);r[0],r[1];return(0,o.useEffect)((function(){e.current=new v.Terminal({rows:40,convertEol:!0,scrollback:10,disableStdin:!1,cursorStyle:"underline",cursorBlink:!0});var i=new y.FitAddon;e.current.loadAddon(i),e.current.onResize((function(t){i.fit()})),e.current.open(n.current),null!=t.data&&g.default[t.data.op]({stdout:function(t){console.log("up_container=",t),e.current&&e.current.write(t)},stderr:function(t){console.log("up_container stderr=",t)},onerr:function(t){console.log("up_container err=",t)},onend:function(){t.onEnd&&t.onEnd()}})}),[t]),(0,Z.jsx)(l.Z,{ref:n,width:"100vh",height:"100vh"})});e.default=function(t){var e=(0,b.useData)(),n=(e.global_data,e.api,(0,o.useState)({install_virt_manager:!1,run_virt_manager:!1,install_dialog:!1,drawOpen:!1,run_cmd:{},openAddDialog:!1,json_editor_option:{disable_edit_json:!0,disable_properties:!0,disable_collapse:!0,no_additional_properties:!0,required_by_default:!0},schema:{$ref:"#/definitions/qemu",definitions:{object:{type:"string",title:"Object",format:"json",default:"{}",options:{ace:{theme:"ace/theme/vibrant_ink",tabSize:2,useSoftTabs:!0,wrap:!0}}},cdrom:{type:"object",title:"\u5149\u76d8\u8bbe\u7f6e",format:"grid",properties:{filename:{type:"string",default:"",title:"ISO\u6587\u4ef6\u8def\u5f84"},bus_options:{type:"string",default:"VirtIO",title:"\u603b\u7ebf\u7c7b\u578b",enum:["VirtIO","scsi","sate","ide","usb"],options:{enum_titles:["VirtIO","scsi","sate","ide","usb"]}},boot_order:{type:"integer",default:2,title:"\u542f\u52a8\u987a\u5e8f"}},required:["filename","bus_options","boot_order"]},disk:{type:"object",title:"\u78c1\u76d8",properties:{filename:{type:"string",default:"",title:"\u78c1\u76d8\u6587\u4ef6\u8def\u5f84"},size:{type:"string",default:"1G",title:"\u78c1\u76d8\u5927\u5c0f"},type:{type:"string",default:"qcow2",title:"\u865a\u62df\u78c1\u76d8\u7c7b\u578b",enum:["qcow2","raw"],options:{enum_titles:["qcow2","raw"]}},bus_options:{type:"string",default:"VirtIO",title:"\u603b\u7ebf\u7c7b\u578b",enum:["VirtIO","scsi","sate","ide","usb"],options:{enum_titles:["VirtIO","scsi","sate","ide","usb"]}},boot_order:{type:"integer",default:1,title:"\u542f\u52a8\u987a\u5e8f"}},required:["filename","size","type","bus_options","boot_order"]},share:{type:"object",title:"\u5171\u4eab",properties:{mode:{type:"string",default:"",title:"\u865a\u62df\u78c1\u76d8\u7c7b\u578b",enum:["9p","virtiofs"],options:{enum_titles:["9p Mode","Virtiofs Mode"]}},source:{type:"string",default:"",title:"\u4e3b\u673a\u76ee\u5f55"},target:{type:"string",default:"",title:"\u865a\u62df\u673a\u6302\u8f7d\u6807\u7b7e"}},required:["mode","source","target"]},gpu:{type:"object",title:"\u663e\u5361",properties:{id:{type:"string",default:"virtual",title:"\u865a\u62df\u78c1\u76d8\u7c7b\u578b",enum:["virtual"],options:{enum_titles:["virtual"]}},source:{type:"string",default:"",title:"\u4e3b\u673a\u76ee\u5f55"},target:{type:"string",default:"",title:"\u865a\u62df\u673a\u6302\u8f7d\u6807\u7b7e"}},required:["mode","source","target"]},machine:{type:"string",title:"Machine",default:"pc-q35-7.1",enum:["pc-q35-7.1","pc-i440fx-6.2"],options:{enum_titles:["pc-q35-7.1","pc-i440fx-6.2"]}},overcommit:{type:"string",title:"overcommit",default:"mem-lock=off",options:{hidden:!0}},smp:{type:"string",title:"\u903b\u8f91CPU",format:"vm_smp",default:"1,sockets=1,dies=1,cores=1,threads=1"},chardev:{type:"string",title:"chardev",default:""},mon:{type:"string",title:"mon",default:""},global:{type:"string",title:"global",default:""},rtc:{type:"string",title:"rtc",default:""},boot:{type:"string",title:"boot",default:""},device:{type:"string",title:"device",format:"json",default:"{}",options:{ace:{theme:"ace/theme/vibrant_ink",tabSize:2,useSoftTabs:!0,wrap:!0}}},netdev:{type:"string",title:"netdev",default:""},audiodev:{type:"string",format:"json",default:"{}",options:{ace:{theme:"ace/theme/vibrant_ink",tabSize:2,useSoftTabs:!0,wrap:!0}}},vnc_auto_port:{type:"object",title:"\u81ea\u52a8",properties:{type:{type:"string",default:"auto_port",options:{hidden:!0}},auto_port:{type:"boolean",default:!0,options:{hidden:!0}}},required:["auto_port","type"]},vnc_port:{type:"object",title:"\u624b\u52a8",properties:{type:{type:"string",default:"port",options:{hidden:!0}},port:{type:"integer",title:"\u76d1\u542c\u7aef\u53e3",default:-1},ws_port:{type:"integer",title:"\u7f51\u9875\u7aef\u53e3",default:-1}},required:["port","ws_port","type"]},vnc:{type:"object",title:"VNC",properties:{id:{type:"string",default:"virtual",options:{hidden:!0}},protocol:{type:"string",default:"vnc",title:"VM Console Protocol:",enum:["vnc","spice"],options:{enum_titles:["VNC","SPICE"]}},port:{type:"object",title:"\u7aef\u53e3",anyOf:[{$ref:"#/definitions/vnc_auto_port"},{$ref:"#/definitions/vnc_port"}]},model:{type:"string",title:"\u9a71\u52a8\u6a21\u5f0f",default:"qxl",enum:["cirrus","qxl","vmvga"],options:{enum_titles:["Cirrus","QXL (best)","vmvga"]}},keymap:{type:"string",title:"VNC\u952e\u76d8",default:"en-us"},password:{type:"string",title:"VNC\u5bc6\u7801",default:""}},required:["id","protocol","port","model","keymap","password"]},nic:{type:"object",title:"\u7f51\u5361",properties:{mac:{type:"string",title:"MAC\u5730\u5740",default:""},network:{type:"string",title:"source",default:""},model:{type:"string",title:"\u7f51\u7edc\u6a21\u5f0f",default:"virtio-net",enum:["virtio-net","virtio","e1000","vmxnet3"],options:{enum_titles:["virtio-net","virtio","e1000","vmxnet3"]}},boot:{type:"integer",title:"\u542f\u52a8\u987a\u5e8f",default:0}},required:["mac","network","model","boot"]},sandbox:{type:"string",title:"sandbox",default:"on,obsolete=deny,elevateprivileges=deny,spawn=deny,resourcecontrol=deny"},msg:{type:"string",title:"msg",default:"timestamp=on"},qemu:{type:"object",title:"\u865a\u62df\u673a\u914d\u7f6e",properties:{name:{type:"string",title:"\u540d\u79f0",default:""},cpu:{type:"string",title:"cpu\u8bbe\u7f6e",enum:["host,migratable=on,host-cache-info=on,l3-cache=off","qemu64"],options:{enum_titles:["\u4e3b\u673a\u76f4\u901a","qemu\u6a21\u62df"]},default:"host,migratable=on,host-cache-info=on,l3-cache=off"},smp:{$ref:"#/definitions/smp"},memory:{type:"integer",title:"\u5185\u5b58\uff08MB\uff09",default:1024},max_memory:{type:"integer",title:"\u6700\u5927\u5185\u5b58\uff08MB\uff09",default:1024},machine:{$ref:"#/definitions/machine"},bios:{type:"string",default:"OVMF",title:"bios\u9009\u62e9",enum:["SeaBIOS","OVMF","OVMF TPM"],options:{enum_titles:["SeaBIOS","OVMF","OVMF TPM"]}},usbboot:{type:"boolean",default:!1,title:"usb\u542f\u52a8"},usbmode:{type:"string",default:"usb2",enum:["usb2","usb3","usb3-qemu"],options:{enum_titles:["2.0 (EHCI)","3.0 (nec XHCI)","3.0 (qemu XHCI)"]}},cdrom:{$ref:"#/definitions/cdrom"},disks:{type:"array",title:"\u78c1\u76d8\u914d\u7f6e",format:"table",items:{$ref:"#/definitions/disk"}},share:{type:"array",title:"\u5171\u4eab\u914d\u7f6e",format:"table",items:{$ref:"#/definitions/share"}},gpu:{type:"array",title:"\u663e\u5361\u914d\u7f6e",items:{type:"object",title:"\u663e\u5361",anyOf:[{$ref:"#/definitions/vnc"}]}},nic:{type:"array",title:"\u7f51\u8def\u914d\u7f6e",items:{$ref:"#/definitions/nic"}},uuid:{type:"string",default:"",options:{hidden:!0}}},required:["name","cpu","smp","memory","max_memory","machine","bios","usbboot","usbmode","cdrom","disks","share","gpu","nic","uuid"]}}}})),c=(0,a.Z)(n,2),l=c[0],v=c[1],y=function(t){v((function(e){return(0,s.Z)((0,s.Z)({},e),t)}))},w=function(){var t=(0,r.Z)((0,i.Z)().mark((function t(){var e,n,r,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.default.check_virt_manager();case 2:e=t.sent,n=!1,r=!1,0==e.ret&&e.data&&(a=e.data.stdout,n=!0,""==a?(n=!0,r=!0):a.includes("not installed")||(n=!0,a.includes("not run")||(r=!0))),y({install_virt_manager:n,run_virt_manager:r});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,o.useEffect)((function(){w()}),[]);var j=function(){var t={};console.log("state===",l),l.install_virt_manager?l.run_virt_manager||(t={op:"run_virt_manager"}):t={op:"install_virt_manager"},t.op?y({install_dialog:!0,run_command:t}):y({install_dialog:!1})},q=(t.onActive,t.onClose,t.onRestore,t.onMaximize,t.onMinimize,(0,o.useRef)(null),(0,h.Z)(u.Z)({width:"80%"})),C=window.location,S="http://".concat(C.host,":8185/");return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(x.default,(0,s.Z)((0,s.Z)({title:"\u865a\u62df\u673a\u7ba1\u7406"},t),{},{children:(0,Z.jsxs)(_.Z,{children:[(!l.install_virt_manager||!l.run_virt_manager)&&(0,Z.jsx)(f.Z,{onClick:j,children:"\u5b89\u88c5\u865a\u62df\u673a\u7ba1\u7406"}),l.run_virt_manager&&(0,Z.jsx)("iframe",{src:S,frameborder:"0",style:{border:"0px",width:"100%",height:"100%",bottom:"0px",left:"0px",right:"0px",top:"0px",position:"fixed"},allowfullscreen:!0}),l.install_dialog&&(0,Z.jsxs)(d.Z,{open:l.install_dialog,onClose:function(){return console.log("close")},children:[(0,Z.jsx)(p.Z,{children:"\u521d\u59cb\u5316"}),(0,Z.jsx)(q,{children:(0,Z.jsx)(k,{data:l.run_command,onEnd:function(){y({install_dialog:!1}),setTimeout((0,r.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w();case 2:setTimeout((function(){j()}));case 3:case"end":return t.stop()}}),t)}))))}})}),(0,Z.jsx)(m.Z,{})]})]})}))})}},38597:function(t,e,n){n.r(e);var i=n(42982),r=n(1413),a=n(74165),s=n(15861),o=n(3623),u=n(11687);function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{stdout:null,stderr:null,onerr:null,onend:null},n=window.location,i=t,r=encodeURIComponent(JSON.stringify(i)),a=new WebSocket(("http:"==n.protocol?"ws://":"wss://")+n.host+"/api/ws/shell?args="+r);a.onopen=function(){a.onclose=function(){a=null,e.onend&&e.onend()},a.onmessage=function(t){console.log(t.data),e.stdout&&e.stdout(t.data)}},a.onerror=function(t){e.onerr&&e.onerr(t),a=null}}var l={command:"qemu-system",arch:"x86_64",check_virt_manager:function(){return(0,s.Z)((0,a.Z)().mark((function t(){var e;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={command:"./scripts/install_virt_manager.sh",args:["check"]},t.next=3,u.default.run_command(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},install_virt_manager:function(){c({command:"./scripts/install_virt_manager.sh",args:["install_virt_manager"]},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{stdout:null,stderr:null,onerr:null,onend:null})},run_virt_manager:function(){c({command:"./scripts/install_virt_manager.sh",args:["run_virt_manager"]},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{stdout:null,stderr:null,onerr:null,onend:null})},check_x11_bridge:function(){return(0,s.Z)((0,a.Z)().mark((function t(){var e;return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={command:"./scripts/install_x11_bridge.sh",args:["check"]},t.next=3,u.default.run_command(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},install_x11_bridge:function(){c({command:"./scripts/install_x11_bridge.sh",args:["install_x11_bridge"]},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{stdout:null,stderr:null,onerr:null,onend:null})},run_x11_bridge:function(){c({command:"./scripts/install_x11_bridge.sh",args:["run_x11_bridge"]},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{stdout:null,stderr:null,onerr:null,onend:null})},install:function(){c({command:"./scripts/install_qemu.sh",args:["qemu"]},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{stdout:null,stderr:null,onerr:null,onend:null})},template:{},parse_address:function(t){return t?{address:{_attributes:{type:"".concat(t.type),domain:"0x0000",bus:"".concat(t.bus),port:(null===t||void 0===t?void 0:t.port)||void 0,function:(null===t||void 0===t?void 0:t.function)||void 0,multifunction:(null===t||void 0===t?void 0:t.multifunction)||void 0}}}:{}},parse_usb:function(t){var e={controller:(0,r.Z)({_attributes:{type:"usb",index:(null===t||void 0===t?void 0:t.index)||"0",model:"".concat(t.model)},alias:{_attributes:{name:(null===t||void 0===t?void 0:t.alias_name)||"usb"}}},this.parse_address(t.address))};return t.master&&(e.controller.master={_attributes:{startport:"".concat(t.master.startport)}}),e},parse_disk:function(t){return{disk:(0,r.Z)({_attributes:{type:"file",device:"disk"},driver:{_attributes:{name:"qemu",type:"".concat(t.type),cache:"writeback"}},source:{_attributes:{file:"".concat(t.filename),index:"".concat(t.boot_order)}},backingStore:{},target:{_attributes:{dev:"hdc",bus:"".concat(t.bus_options)}},boot:{_attributes:{order:"".concat(t.boot_order)}},alias:{_attributes:{name:"virtio_disk2"}}},this.parse_address((null===t||void 0===t?void 0:t.address)||{type:"pci",bus:"0x03",slot:"0x00",function:"0x0"}))}},parse_pci:function(t){var e={controller:(0,r.Z)({_attributes:{type:"pci",index:"".concat(t.index),model:"".concat(t.model)},alias:{_attributes:"".concat(t.alias_name)}},this.parse_address((null===t||void 0===t?void 0:t.address)||{}))};if(t.model_name&&(e.controller.model={_attributes:{name:"".concat(t.model_name)}}),t.target){var n=t.target;e.controller.target={_attributes:{classis:"".concat(n.classis),port:"".concat(n.port)}}}return e},parse_network:function(t){return{interface:(0,r.Z)({_attributes:{type:(null===t||void 0===t?void 0:t.type)||"bridge"},mac:{_attributes:{address:"".concat(t.mac)}},source:{_attributes:{bridge:"".concat(t.network)}},target:{_attributes:{dev:"".concat(t.target)}},model:{_attributes:{type:"".concat(t.model)}},alias:{_attributes:{name:"".concat(t.alias_name)}}},this.parse_address(t.address))}},parse_serial:function(t){return{serial:{_attributes:{type:"".concat(t.type),tty:(null===t||void 0===t?void 0:t.tty)||void 0},source:{_attributes:{path:"".concat(t.path)}},target:{_attributes:{type:"".concat(t.target_type),port:"".concat(t.port)},model:{_attributes:{name:"".concat(t.target_type)}}},alias:{_attributes:{name:"".concat(t.alias_name)}}}}},parse_channel:function(t){return{channel:(0,r.Z)({_attributes:{type:"unix"},source:{_attributes:{mode:"bind",path:"".concat(t.path)}},target:{_attributes:{type:"virtio",name:"org.qemu.guest_agent.0",state:"disconnected"}},alias:{_attributes:{name:"channel0"}}},this.parse_address(t.address))}},parse_input:function(t){return{input:(0,r.Z)({_attributes:{type:"".concat(t.type),bus:"".concat(t.bus)},alias:{_attributes:{name:"".concat(t.alias_name)}}},this.parse_address(t.address))}},parse_console:function(t){return{console:{_attributes:{type:"pty",tty:"/dev/pts/2"},source:{_attributes:{path:"/dev/pts/2"}},target:{_attributes:{type:"serial",port:0}},alias:{_attributes:{name:"serial0"}}}}},parse_config:function(t){var e=this;console.log("config===",t);var n=[{model:"ich9-ehci1",address:{type:"pci",bus:"0x00",slot:"0x07",function:"0x0",multifunction:"on"}},{model:"ich9-uhci1",address:{type:"pci",bus:"0x00",slot:"0x07",function:"0x0"},master:{startport:0}},{model:"ich9-uhci2",address:{type:"pci",bus:"0x00",slot:"0x07",function:"0x1"},master:{startport:2}},{model:"ich9-uhci3",address:{type:"pci",bus:"0x00",slot:"0x07",function:"0x2"},master:{startport:4}}].map((function(t){return e.parse_usb(t)})),a=t.disks.map((function(t){return e.parse_disk(t)})),s=[(0,r.Z)({bus:0,target:0,unit:0,target_dev:"hda"},t.cdrom)].map((function(t,e){return{disk:{_attributes:{type:"file",device:"cdrom"},driver:{_attributes:{name:"qemu",type:"raw"}},source:{_attributes:{file:"".concat(t.filename),index:"".concat(e)}},backingStore:{},target:{_attributes:{dev:"".concat(t.target_dev),bus:"".concat(t.bus_options),tray:"open"}},readonly:{},boot:{_attributes:{order:"".concat(t.boot_order)}},alias:{_attributes:{name:"".concat(t.bus_options).concat(t.bus,"-").concat(t.target,"-").concat(t.unit)}}}}})),u=[{type:"sata",alias_name:"ide",address:{type:"pci",bus:"0x00",slit:"0x1f",function:"0x2"}}].map((function(t,n){return{controller:(0,r.Z)({_attributes:{type:"".concat(t.type),index:"".concat(n)},alias:{_attributes:"".concat(t.alias_name)}},e.parse_address(t.address))}})),c=[{model:"pcie-root",alias_name:"pcie.0"},{model:"pcie-root-port",model_name:"pcie-root-port",alias_name:"pci.1",target:{chassis:"1",port:"0x10"},address:{type:"pci",bus:"0x00",slot:"0x02",function:"0x0",multifunction:"on"}},{model:"pcie-root-port",model_name:"pcie-root-port",alias_name:"pci.2",target:{chassis:"2",port:"0x11"},address:{type:"pci",bus:"0x00",slot:"0x02",function:"0x1"}},{model:"pcie-root-port",model_name:"pcie-root-port",alias_name:"pci.3",target:{chassis:"3",port:"0x12"},address:{type:"pci",bus:"0x00",slot:"0x02",function:"0x2"}},{model:"pcie-root-port",model_name:"pcie-root-port",alias_name:"pci.4",target:{chassis:"4",port:"0x13"},address:{type:"pci",bus:"0x00",slot:"0x02",function:"0x3"}},{model:"pcie-root-port",model_name:"pcie-root-port",alias_name:"pci.5",target:{chassis:"5",port:"0x14"},address:{type:"pci",bus:"0x00",slot:"0x02",function:"0x4"}}].map((function(t,n){return e.parse_pci((0,r.Z)((0,r.Z)({},t),{},{index:n}))})),l=(0,i.Z)(t.nic).map((function(t,n){return e.parse_network(t)})),d=[{type:"pty",path:"/dev/pts/2",alias_name:"serial0",port:"0",target_type:"isa-serial"},{type:"pty",path:"/dev/pts/2",tty:"/dev/pts/2",alias_name:"serial0",port:"0",target_type:"serial"}].map((function(t){return e.parse_serial(t)})),p=[{path:"org.qemu.guest_agent.0"}].map((function(t){return e.parse_channel(t)})),m=[{}].map((function(t){return e.parse_console(t)})),f=[{type:"tablet",bus:"usb",alias_name:"input0",address:{type:"usb",bus:"0",port:"1"}},{type:"mouse",bus:"ps2",alias_name:"input1"},{type:"keyboard",bus:"ps2",alias_name:"input2"}].map((function(t){return e.parse_input(t)})),_=(0,r.Z)((0,r.Z)({},this.template),{},{name:{_text:"".concat(t.name)},metadata:{},memory:{_attributes:{unit:"KiB"},_text:"".concat(1024*t.memory)},currentMemory:{_attributes:{unit:"KiB"},_text:"".concat(1024*t.memory)},vcpu:{_attributes:{placement:"static"},_text:"".concat(t.smp)},cputune:{vcpuin:[{_attributes:{vcpu:"".concat(0),cpuset:"".concat(0)}}]},os:{type:{_attributes:{arch:"x86_64",machine:"".concat(t.machine)},_text:"hvm"},loader:{_attributes:{readonly:"yes",type:"pflash"},_text:"/usr/share/qemu/ovmf-x64/OVMF_CODE-pure-efi.fd"},nvram:{_text:"/etc/libvirt/qemu/nvram/99c36dce-e5af-5de4-b61f-17ea21137658_VARS-pure-efi.fd"}},features:{acpi:{},apic:{}},cpu:{_attributes:{mode:"host-passthrough",check:"none",migratable:"on"},topology:{_attributes:{sockets:"1",dies:"1",cores:"1",threads:"1"}},cache:{_attributes:{mode:"passthrough"}}},clock:{_attributes:{offset:"utc"},timer:[{_attributes:{name:"rtc",tickpolicy:"catchup"}},{_attributes:{name:"pit",tickpolicy:"delay"}},{_attributes:{name:"hpet",tickpolicy:"no"}}]},on_poweroff:{_text:"destroy"},on_reboot:{_text:"restart"},on_crash:{_text:"restart"},devices:(0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({emulator:{_text:"/usr/local/sbin/qemu"},disk:(0,i.Z)(a),cdrom:(0,i.Z)(s)},n),u),c),l),d),p),m),f)}),h=(0,o.js2xml)(_,{compact:!0,ignoreComment:!0,spaces:4});console.log("ret==",h)}};e.default=l}}]);
//# sourceMappingURL=584.74b050b6.chunk.js.map